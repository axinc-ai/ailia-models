# InaSpeechSegmenter is audio segmentation.

## input
Audio file

```
musanmix.mp3
musanmix.mp3 was generated by concatenation of 3 open license files provided in corpus MUSAN:
noise-free-sound-0442.wav
music-hd-0048.wav
speech-librivox-0130.wav  
```

## output

It splits audio signals into homogeneous zones of speech, music and noise. Speech zones are split into segments tagged using speaker gender.

```
labels: music ,start: 0.0 ,stop: 22.48
labels: noEnergy ,start: 22.48 ,stop: 29.080000000000002
labels: noise ,start: 29.080000000000002 ,stop: 52.800000000000004
labels: noEnergy ,start: 52.800000000000004 ,stop: 54.78
labels: noise ,start: 54.78 ,stop: 55.74
labels: noEnergy ,start: 55.74 ,stop: 63.34
labels: male ,start: 63.34 ,stop: 68.26
labels: noEnergy ,start: 68.26 ,stop: 68.92
labels: male ,start: 68.92 ,stop: 71.60000000000001
labels: noEnergy ,start: 71.60000000000001 ,stop: 72.0
labels: male ,start: 72.0 ,stop: 73.82000000000001
labels: noEnergy ,start: 73.82000000000001 ,stop: 74.5

```


## Usage

Automatically downloads the onnx and prototxt files on the first run.
It is necessary to be connected to the Internet while downloading.

For the sample wav,
```bash
$ python3 inaSpeechSegmenter.py 
```

You can run with other wav file by adding `--input` option.
```bash
$ python3 inaSpeechSegmenter.py --input [wav_file]
```

You can also use an -m option. speech and music segmentation model by adding the `sm`  or music and noise segmentation model by adding the `smn`.Default is `smn`

```bash
$ python3 inaSpeechSegmenter.py -m smn
```

## Reference
[inaSpeechSegmenter](https://github.com/ina-foss/inaSpeechSegmenter)  

## Framework
pytorch 2.0.0

## Model Format
ONNX opset = 14

## Netron

[inaSpeechSegmenter_sm.onnx.prototxt](https://netron.app/?url=https://storage.googleapis.com/ailia-models/inaSpeechSegmenter/inaSpeechSegmenter_smn.onnx.prototxt)

[inaSpeechSegmenter_sm.onnx.prototxt](https://netron.app/?url=https://storage.googleapis.com/ailia-models/inaSpeechSegmenter/inaSpeechSegmenter_smn.onnx.prototxt)

[inaSpeechSegmenter_gender.onnx.prototxt](https://netron.app/?url=https://storage.googleapis.com/ailia-models/inaSpeechSegmenter/inaSpeechSegmenter_gender.onnx.prototxt)
