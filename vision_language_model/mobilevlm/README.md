# MobileVLM

## Input

- Image

  ![Input](demo.jpg)

  (Sample image showing a book cover)

- Prompt

  Who is the author of this book? Answer in a single sentence.

## Output

- Sentence generated by the VLM. In the example above, it will be:

Susan Wise Bauer.

## Requirements

This model requires additional modules.

If you want to use the transformers tokenizer instead of ailia_tokenizer:

```
pip install transformers
```

## Usage
Automatically downloads the onnx and prototxt files on the first run.
It is necessary to be connected to the Internet while downloading.

For the sample image,
```bash
$ python3 mobilevlm.py
```

If you want to specify the input image, put the image path after the `--input` option.  
```bash
$ python3 mobilevlm.py --input IMAGE_PATH --prompt "Describe this image."
```

If you want to specify the prompt, put the prompt after the `--prompt` option.  
```bash
$ python3 mobilevlm.py --prompt "What is shown in this image?"
```

You can select the model size with the `--model_size` option:
```bash
$ python3 mobilevlm.py --model_size 1.7B  # Options: 1.7B, 3B
```

<!--->
Due to computational limitations, 3B model only supports fp16.

To use FP16 precision for faster inference:
```bash
$ python3 mobilevlm.py --fp16
```
<!--->


### Input Format

The model automatically formats your input with the following structure:
1. A system prompt that identifies the assistant's role
2. The image token `<image>` to indicate where the image should be processed
3. Your provided prompt text

You don't need to include the image token in your prompt as it will be added automatically. 

## Reference

- [MobileVLM](https://github.com/Meituan-AutoML/MobileVLM)

## Framework

PyTorch

## Model Format

ONNX opset=14

## Netron

[mobilellama_17.onnx.prototxt](https://netron.app/?url=https://storage.googleapis.com/ailia-models/mobilevlm/mobilellama_17.onnx.prototxt)  
[vision_tower_17.onnx.prototxt](https://netron.app/?url=https://storage.googleapis.com/ailia-models/mobilevlm/vision_tower_17.onnx.prototxt)  
[mm_projector_17.onnx.prototxt](https://netron.app/?url=https://storage.googleapis.com/ailia-models/mobilevlm/mm_projector_17.onnx.prototxt)  
[token_embedder_17.onnx.prototxt](https://netron.app/?url=https://storage.googleapis.com/ailia-models/mobilevlm/token_embedder_17.onnx.prototxt)