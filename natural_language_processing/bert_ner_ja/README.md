# T5 base Japanese ner

Named entity recogtinion model made by fine-tuning [sonoisa/t5-base-japanese](https://huggingface.co/sonoisa/t5-base-japanese)

## Input

[TEXT file.](./input.txt)
The default text is "伊藤左千夫は1893年から知人から学んだ短歌を詠むようになったが、当初は古今和歌集の流れをくむ月並調の伝統的な短歌を詠んでいた。"

## Output

Dictionary of the recognized named entities.
Each entries in the dictionary contains the token, the predicted tag, and its score.
```bash
 INFO bert_ner_ja.py (138) : {0: {'label': 'B-人名', 'score': 0.9979887, 'token': '伊藤'},
 1: {'label': 'I-人名', 'score': 0.9980009, 'token': '左'},
 2: {'label': 'I-人名', 'score': 0.99771273, 'token': '千'},
 3: {'label': 'I-人名', 'score': 0.99759763, 'token': '夫'},
 4: {'label': 'O', 'score': 0.99991703, 'token': 'は'},
 5: {'label': 'O', 'score': 0.9998727, 'token': '1893'},
 6: {'label': 'O', 'score': 0.99988675, 'token': '年'},
 7: {'label': 'O', 'score': 0.99992526, 'token': 'から'},
 8: {'label': 'O', 'score': 0.99984384, 'token': '知人'},
 9: {'label': 'O', 'score': 0.9998889, 'token': 'から'},
 10: {'label': 'O', 'score': 0.99989784, 'token': '学ん'},
 11: {'label': 'O', 'score': 0.9999082, 'token': 'だ'},
 12: {'label': 'O', 'score': 0.9998729, 'token': '短歌'},
 13: {'label': 'O', 'score': 0.99992454, 'token': 'を'},
 14: {'label': 'O', 'score': 0.999918, 'token': '詠'},
 15: {'label': 'O', 'score': 0.999931, 'token': 'む'},
 16: {'label': 'O', 'score': 0.99992776, 'token': 'よう'},
 17: {'label': 'O', 'score': 0.99992144, 'token': 'に'},
 18: {'label': 'O', 'score': 0.9999201, 'token': 'なっ'},
 19: {'label': 'O', 'score': 0.99993217, 'token': 'た'},
 20: {'label': 'O', 'score': 0.99992645, 'token': 'が'},
 21: {'label': 'O', 'score': 0.99994326, 'token': '、'},
 22: {'label': 'O', 'score': 0.99992967, 'token': '当初'},
 23: {'label': 'O', 'score': 0.9999305, 'token': 'は'},
 24: {'label': 'B-製品名', 'score': 0.8574821, 'token': '古今'},
 25: {'label': 'I-製品名', 'score': 0.7041578, 'token': '和歌'},
 26: {'label': 'O', 'score': 0.49519515, 'token': '集'},
 27: {'label': 'O', 'score': 0.99985087, 'token': 'の'},
 28: {'label': 'O', 'score': 0.9998497, 'token': '流れ'},
 29: {'label': 'O', 'score': 0.9998128, 'token': 'を'},
 30: {'label': 'O', 'score': 0.9998615, 'token': 'く'},
 31: {'label': 'O', 'score': 0.9998894, 'token': 'む'},
 32: {'label': 'O', 'score': 0.9519039, 'token': '月'},
 33: {'label': 'O', 'score': 0.9302413, 'token': '並'},
 34: {'label': 'O', 'score': 0.98535293, 'token': '調'},
 35: {'label': 'O', 'score': 0.9998259, 'token': 'の'},
 36: {'label': 'O', 'score': 0.9997893, 'token': '伝統'},
 37: {'label': 'O', 'score': 0.99981016, 'token': '的'},
 38: {'label': 'O', 'score': 0.99982613, 'token': 'な'},
 39: {'label': 'O', 'score': 0.99979764, 'token': '短歌'},
 40: {'label': 'O', 'score': 0.99991095, 'token': 'を'},
 41: {'label': 'O', 'score': 0.9999194, 'token': '詠ん'},
 42: {'label': 'O', 'score': 0.99992454, 'token': 'で'},
 43: {'label': 'O', 'score': 0.99993455, 'token': 'い'},
 44: {'label': 'O', 'score': 0.999946, 'token': 'た'},
 45: {'label': 'O', 'score': 0.9999497, 'token': '。'}}
```

The class is described using IOB tags, which is explained below. 
### Outside (O)
This tag is assigned to a token when it is outside of any named entity.

### Beginning (B)
This tag is assigned to a token when it marks the beginning of an named entity. The string following B- indicates the class of the entity.

### Inside (I)
This tag is assigned to a token when it is part of an named entity, but not in the beginning. The string following I- indicates the class of the entity.

The following 8 classes were used when training this model.
{人名, 法人名, 政治的組織名, その他の組織名, 地名, 施設名, 製品名, イベント名}

## Usage

An Internet connection is required when running the script for the first time, as the model files will be downloaded automatically.

Predicted named entities in the input text file will be automatically generated by running the script below.

```bash
$ python3 bert_ner_ja.py -f input.txt
```

Here is how to use the ```-i``` (or ```--input```) argument instead.
```bash
$ python3 bert_ner_ja.py -i 2008年10月5日、アウェーでのレクレアティーボ・ウェルバ戦でプリメーラ・ディビシオンでの初得点を決めた。
```

By using the ```--savepath``` option, the pickle of the list will be saved to the specified path.
```bash
$ python3 bert_ner_ja.py -f input.txt -s result.pickle
```

## Reference

- [bert-ner-japanese](https://huggingface.co/jurabi/bert-ner-japanese)

### Framework
PyTorch

## Model Format

ONNX opset=12

## Netron

[bert_ner_ja.onnx.prototxt](https://netron.app/?url=https://storage.googleapis.com/ailia-models/bert_ner_ja/bert_ner_ja.onnx.prototxt)